openapi: 3.0.3
info:
  title: AppsFlyer Raw Data Pull API - Attributed Ad Revenue (v5)
  version: "1.0.0"
  description: |
    Attributed ad revenue raw data export (non-organic).
    Records ad revenue generated by users attributed to a media source.
    Data freshness: Daily.

servers:
  - url: https://hq1.appsflyer.com

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

security:
  - BearerAuth: []

paths:
  /api/raw-data/export/app/{app-id}/ad_revenue_raw/v5:
    get:
      operationId: getAttributedAdRevenueReportV5
      summary: Attributed ad revenue raw data report
      description: |
        Exports a raw-data report of attributed ad revenue events (non-organic).
        Records ad revenue for users attributed to a media source.
        Data freshness is daily.
      security:
        - BearerAuth: []
      parameters:
        # Path parameters
        - name: app-id
          in: path
          required: true
          description: Application ID.
          schema:
            type: string

        # Required query parameters
        - name: from
          in: query
          required: true
          description: From date (report start date), inclusive.
          schema:
            type: string
            format: date
            example: "2025-11-01"

        - name: to
          in: query
          required: true
          description: To date (report end date), inclusive.
          schema:
            type: string
            format: date
            example: "2025-11-07"

        # Optional filters (same pattern as other Raw Data API)
        - name: media_source
          in: query
          required: false
          description: |
            Use to filter by a specific media source.

            Set both the category and media_source parameters as follows:
            - Facebook: category=facebook, media_source=facebook
            - Twitter: category=twitter, media_source=twitter
            - Others: category=standard, media_source={name}

            Examples:
            - media_source=facebook&category=facebook
            - media_source=abc_example&category=standard
          schema:
            type: string
            example: facebook

        - name: category
          in: query
          required: false
          description: |
            media_source category. Must be used together with media_source.

            Values:
            - standard
            - facebook
            - twitter
          schema:
            type: string
            enum:
              - standard
              - facebook
              - twitter
            example: standard

        - name: currency
          in: query
          required: false
          description: |
            Currency of revenue and cost.

            - preferred: app-specific currency (default)
            - USD
          schema:
            type: string
            enum:
              - preferred
              - USD
            example: preferred

        - name: timezone
          in: query
          required: false
          description: |
            Time zone used for the report.

            - If not sent → UTC
            - If app has a configured time zone, use: timezone=Europe/Paris
          schema:
            type: string
            example: Europe/Paris

        - name: geo
          in: query
          required: false
          description: |
            Filter the report by country code.
            Only 1 country code allowed per request.
            ISO 3166-1 alpha-2 format (US, JP, CN…)
          schema:
            type: string
            maxLength: 2
            example: US

        - name: maximum_rows
          in: query
          required: false
          description: |
            Maximum number of rows returned per API call.

            - Not sent → 200K
            - 200000 → up to 200K rows
            - 1000000 → up to 1M rows
          schema:
            type: integer
            enum:
              - 200000
              - 1000000
            example: 200000

        - name: from_install_time
          in: query
          required: false
          description: From install timestamp filter.
          schema:
            type: string
            format: date-time
            example: "2025-11-01T00:00:00Z"

        - name: to_install_time
          in: query
          required: false
          description: To install timestamp filter.
          schema:
            type: string
            format: date-time
            example: "2025-11-08T00:00:00Z"

        - name: agency
          in: query
          required: false
          description: |
            Filter by specific agency (comma-separated if multiple).
          schema:
            type: array
            items:
              type: string
            example:
              - sample_agency
          style: form
          explode: false

        - name: additional_fields
          in: query
          required: false
          description: |
            Comma-separated list of additional raw-data fields.

            Default fields (if nothing is sent):
            store_reinstall, impressions, contributor3_match_type, gp_click_time, match_type,
            mediation_network, oaid, deeplink_url, blocked_reason, blocked_sub_reason,
            gp_broadcast_referrer, gp_install_begin, custom_data, rejected_reason,
            device_download_time, keyword_match_type, contributor1_match_type,
            contributor2_match_type, device_model, monetization_network, segment,
            is_lat, gp_referrer, blocked_reason_value, store_product_page,
            device_category, rejected_reason_value, ad_unit, keyword_id, placement,
            network_account_id, install_app_store, amazon_aid, engagement_type
          schema:
            type: array
            items:
              type: string
            example:
              - store_reinstall
              - impressions
              - gp_click_time
          style: form
          explode: false

      responses:
        "200":
          description: Raw attributed ad revenue report in CSV format.
          content:
            text/csv:
              schema:
                type: string
                format: binary
        "401":
          description: Unauthorized – invalid or missing bearer token.
        "4XX":
          description: Client error – invalid parameters or other request issues.
        "5XX":
          description: Server error on AppsFlyer side.
